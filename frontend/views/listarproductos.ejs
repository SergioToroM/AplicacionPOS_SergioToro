<!DOCTYPE html>
<html lang="en">

<head>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="../static/styles/styles.css">
    <!-- <%- include('head'); %> -->
        <title>FreakStore - Lista Productos</title>
        
</head>

<body class="container">

<header>
    <%- include('header'); %>
</header>

    <main><br><br><br>
        <div class="form-group">
            <form>
                <h2>Lista productos</h2>
                <table id="products">
                    <thead>
                        <tr>
                            <th>Id</th>
                            <th>Referencia</th>
                            <th>Nombre</th>
                            <th>Descripción</th>
                            <th>Precio</th>
                            <th>Stock</th>
                            <th>Administrar</th>
                        </tr>
                    </thead>
                    <tbody>

                        <% listaproductos.forEach(function(listproducts) { %>
                            <tr>
                                <td>
                                    <%=listproducts.id %>
                                </td>
                                <td>
                                    <%=listproducts.referencia %>
                                </td>
                                <td>
                                    <%=listproducts.nombre %>
                                </td>
                                <td>
                                    <%=listproducts.descripcion %>
                                </td>
                                <td>
                                    <%=listproducts.precio %>
                                </td>
                                <td>
                                    <%=listproducts.stock %>
                                </td>
                                <td>
                                    <button type="button" id="edit" class="button button1" data-bs-toggle="modal" data-bs-target="#modificarProducto" onclick="editarProducto(`<%=listproducts.id %>`,`<%=listproducts.referencia %>`,`<%=listproducts.nombre %>`,`<%=listproducts.descripcion %>`,`<%=listproducts.precio %>`,`<%=listproducts.stock %>`)"><i class="fa fa-edit"></i> Modificar</button>
                                    <button type="button" id="delete" class="button button2" data-toggle="modal" data-target="#eliminarProducto"><i class="fa fa-close"></i> Eliminar</button></td>


                            </tr>
                            <% }); %>
                    </tbody>

                </table>
            </form>

        </div>

  
        <!-- Modal editar -->
        <div class="modal fade" id="modificarProducto" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">

                    <div class="modal-header">
                        <h3 class="modal-title fs-5" id="exampleModalLabel">Modificar artículo</h3>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                        <div class="modal-body">
                            <form action="modifProducto" method="post">
                                
                                <div class="mb-3">
                                    <label for="recipient-name" class="col-form-label">ID:</label>
                                    <input type="text" class="form-control" id="_id" name="_id" readonly>
                                  </div>
                                  <div class="mb-3">
                                    <label for="message-text" class="col-form-label">Referencia:</label>
                                    <input type="text" class="form-control" id="idreferenciaprod" name="refProd">
                                  </div>
                                  <div class="mb-3">
                                      <label for="message-text" class="col-form-label">Nombre:</label>
                                      <input type="text" class="form-control" id="idnombreproducto" name="nombreProd">
                                  </div>
                                  <div class="mb-3">
                                    <label for="message-text" class="col-form-label">Descripción:</label>
                                    <input type="text" class="form-control" id="iddescripcionprod" name="descripc">
                                </div>
                                <div class="mb-3">
                                    <label for="message-text" class="col-form-label">Precio:</label>
                                    <input type="text" class="form-control" id="idprecioprod" name="precioProd">
                                </div>
                                <div class="mb-3">
                                    <label for="message-text" class="col-form-label">Stock:</label>
                                    <input type="text" class="form-control" id="idstockprod" name="stock">
                                </div>
                        
                                    
                                    <button type="submit" id="registrar" class="button button1">Guardar cambios</button>

                            </form>
                        </div>
                     
                    </div>
                </div>
            </div>
        </div>

  
        <!-- Modal eliminar -->
        <div class="modal fade" id="eliminarProducto" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <!-- <div class="modal-header">
                        <h3 class="modal-title fs-5" id="exampleModalLabel">Está seguro de eliminar artículo?</h3>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div> -->

                    <div class="modal-body">
                        <form action="eliminarPr" method="post">
                            <h4>Está seguro de eliminar artículo?</h4>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" id="delete" class="button button1" data-bs-dismiss="modal">Eliminar</button>
                    </div>
                </div>
            </div>
        </div>
        


    </main>

    <footer>
        <%- include('footer'); %>
    </footer>

    <script>
        function editarProducto(idpr,referencia,nombre,descripcion,precio,stock) {
            console.log(idpr,referencia,nombre,descripcion, precio, stock)
            _id.value = idpr;
            idreferenciaprod.value = referencia;
            idnombreproducto.value = nombre;
            iddescripcionprod.value = descripcion;
            idprecioprod.value = precio;
            idstockprod.value = stock;
        }

        function eliminarProducto(id){
            var form = eliminarPr;
            form.setAttribute('action', `/controller/eliminarProd/${id}`);

        }

    </script>

</body>

</html>